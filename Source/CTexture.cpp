#include "CTexture.h"
#include "CSampler.h"
#include "CRender.h"


namespace glliba
{
	/////////////////////////////////////////////////////////////////////////////////////////////////////
	
	int CTexture::s_iTextureCount = -1;
	
	/////////////////////////////////////////////////////////////////////////////////////////////////////

	CTexture::CTexture()
		: CObject()
		, m_eTarget(TD_INVALID)
		, m_scale(1.0f,1.0f)
		, m_iTextureID(0)
		, m_attribute("texture0")
	{
		++s_iTextureCount;

		m_pSampler = new CSampler();
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

	CTexture::~CTexture()
	{
		--s_iTextureCount;

		delete m_pSampler;
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

	Vector2 CTexture::getScale() const
	{
		return m_scale;
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

	void CTexture::setScale( const Vector2& _scale )
	{
		m_scale = _scale;
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

	uint CTexture::getTextureIndex() const
	{
		return m_iTextureID;
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

	void CTexture::bind( uint _iTextureLayer )
	{
		m_pSampler->update();

		RENDER->bindTexture( m_iTextureID, m_pSampler->getSamplerID(), _iTextureLayer,
			m_attribute, m_eTarget,  m_scale );
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

	void CTexture::setAttributeTexture( const std::string& _attribute )
	{
		m_attribute = _attribute;
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////
	
	std::string CTexture::getAttributeTexture() const
	{
		return m_attribute;
	}

	/////////////////////////////////////////////////////////////////////////////////////////////////////

} //glliba